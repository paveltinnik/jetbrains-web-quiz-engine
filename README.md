# jetbrains-web-quiz-engine
## Регистрация пользователя
Для регистрации нового пользователя отправьте `POST` запрос на URL `localhost:8889/api/register` с телом запроса в виде, представленном ниже. Пароль хранится закодированным с помощью `BCrypt`:
```json
{
  "email": "test@gmail.com",
  "password": "secret"
}
```
Сервер возвращает код состояния `200 (OK)`, если регистрация была успешно завершена.

Если `email` уже занят другим пользователем, сервер вернет код состояния `400 (Bad request)`.

Вот некоторые дополнительные ограничения на формат учетных данных пользователя:
- `email` должен иметь правильный формат (с `@` и `.`);
- `password` должен состоять не менее чем из пяти символов.
Если какой-либо из них не удовлетворен, сервер также вернет код состояния `400 (Bad request)`.
Для успешного выполнения всех следующих операций требуется зарегистрированный пользователь. 
## Создание нового теста
Чтобы создать новый тест, клиенту необходимо отправить JSON в качестве тела запроса через `POST` в `/api/quizzes`. JSON должен содержать четыре поля:
`title`: обязательная строка;
`text`: обязательная строка;
`options`: массив строк, обязательный, должен содержать не менее 2-х элементов;
`answer`: массив индексов правильных вариантов, необязателен, так как все варианты могут быть неправильными.
Вот новый JSON тест в качестве примера:
```json
{
  "title": "Coffee drinks",
  "text": "Select only coffee drinks.",
  "options": ["Americano","Tea","Cappuccino","Sprite"],
  "answer": [0,2]
}
```
`answer` равный `[0,2]` соответствует первому и третьему пункту из массива опций (`"Americano"` и `"Cappuccino"`).

Ответ сервера представляет собой JSON с четырьмя полями: `id`, `title`, `text` и `options`. Вот пример:
```json
{
  "id": 1,
  "title": "Coffee drinks",
  "text": "Select only coffee drinks.",
  "options": ["Americano","Tea","Cappuccino","Sprite"]
}
```
Поле `id` - это сгенерированный уникальный целочисленный идентификатор для вопроса.

Если запрос JSON не содержит `title` или `text`, или они представляют собой пустые строки (`""`), то сервер должен ответить кодом состояния `400 (Bad request)`. Если количество вариантов в тесте меньше 2, сервер возвращает тот же код состояния. 
## Решение теста
Чтобы решить тест, клиент отправляет запрос `POST` в `/api/quizzes/{id}/solve` с JSON, который содержит индексы всех выбранных параметров в качестве ответа. Это выглядит как обычный объект JSON с ключом `"answer"` и значением в виде массива: `{"answer": [0,2]}`. Как и раньше, индексы начинаются с нуля.

Также можно отправить пустой массив `[]`, поскольку в некоторых тестах могут быть неверные параметры.

Сервер возвращает JSON с двумя полями: `success` (`true` или `false`) и `feedback` (просто строка). Есть три возможных ответа.

- Если принятый ответ правильный:
```json
{"success":true,"feedback":"Congratulations, you're right!"}
```
- Если ответ неверный:
```json
{"success":false,"feedback":"Wrong answer! Please, try again."}
```
- Если указанный тест не существует, сервер возвращает код состояния `404 (Not found)`.
## Удаление теста
Пользователь может удалить свой тест, отправив запрос `DELETE` по адресу `/api/quizzes/{id}`.
Если операция прошла успешно, сервер вернет код состояния `204 (No content)` без какого-либо содержимого.
Если указанный тест не существует, сервер возвращает `404 (Not found)`. Если указанный пользователь не является автором этого теста, ответом будет код статуса `403 (Forbidden)`.
## Получить все тесты с разбивкой по страницам
Чтобы получить все существующие в службе тесты, клиент отправляет запрос `GET` в `/api/quizzes`. Но вот в чем проблема: количество сохраненных викторин может быть очень большим, поскольку сервис пользуется большой популярностью среди такого количества пользователей.

В связи с этим API должен возвращать только 10 тестов одновременно и поддерживать возможность указывать, какая часть тестов необходима.

Ответ содержит JSON с тестами (внутри `content`) и некоторыми дополнительными метаданными: 
```json
{
  "totalPages":1,
  "totalElements":3,
  "last":true,
  "first":true,
  "sort":{ },
  "number":0,
  "numberOfElements":3,
  "size":10,
  "empty":false,
  "pageable": { },
  "content":[
    {"id":102,"title":"Test 1","text":"Text 1","options":["a","b","c"]},
    {"id":103,"title":"Test 2","text":"Text 2","options":["a", "b", "c", "d"]},
    {"id":202,"title":"The Java Logo","text":"What is depicted on the Java logo?",
     "options":["Robot","Tea leaf","Cup of coffee","Bug"]}
  ]
}
```
API поддерживает навигацию по страницам, передавая параметр страницы (`/api/quizzes?page=1`). Первая страница равна 0, так как страницы начинаются с нуля, как и в наших тестах.

Если тестов нет, `content` пустой `[]`. Если пользователь авторизован, код состояния - `200 (ОК)`; в противном случае - `401 (Unauthorized)`. 
## Получить все ответы на тесты с разбивкой по страницам
Севис предоставляет операцию для получения всех завершенных тестов для указанного пользователя, отправив запрос `GET` в `/api/quizzes/completed` вместе с данными аутентификации пользователя. Все завершенные работы отсортированы от самых новых к самым старым.

Ответ разделяется страницами, так как служба может возвращать много данных. Он содержит JSON с тестами (внутри `content`) и некоторые дополнительные метаданные, как и в предыдущей операции.

Вот пример ответа: 
```json
{
  "totalPages":1,
  "totalElements":5,
  "last":true,
  "first":true,
  "empty":false,
  "content":[
    {"id":103,"completedAt":"2019-10-29T21:13:53.779542"},
    {"id":102,"completedAt":"2019-10-29T21:13:52.324993"},
    {"id":101,"completedAt":"2019-10-29T18:59:58.387267"},
    {"id":101,"completedAt":"2019-10-29T18:59:55.303268"},
    {"id":202,"completedAt":"2019-10-29T18:59:54.033801"}
  ]
}
```
Поскольку разрешено решать тест несколько раз, ответ может содержать повторяющиеся тесты, но с другой датой завершения.

Если викторин нет, `content` пустой `[]`. Если пользователь авторизован, код состояния - `200 (ОК)`; в противном случае - `401 (Unauthorized)`. 
